function [u, Wc, Pc] = CtrlScara(t, z, param, traj)

% model param
l1  = param.l1;
l2  = param.l2;
J1z = param.J1z;
m2  = param.m2;
J2z = param.J2z;
s2x = param.s2x;
s2y = param.s2y;

% model state
x = z(1:2);
xi = z(3:4);

% model matrices
A = [1 0; 0 1;];
M = [l1 ^ 2 * m2 + (0.2e1 * cos(x(2)) * s2x - 0.2e1 * sin(x(2)) * s2y) * m2 * l1 + J1z + J2z (cos(x(2)) * s2x - sin(x(2)) * s2y) * m2 * l1 + J2z; (cos(x(2)) * s2x - sin(x(2)) * s2y) * m2 * l1 + J2z J2z;];
f = [(-xi(2) * (2 * xi(1) + xi(2)) * s2x * sin(x(2)) - xi(2) * (2 * xi(1) + xi(2)) * s2y * cos(x(2))) * m2 * l1; ((xi(1) ^ 2) * s2x * sin(x(2)) + (xi(1) ^ 2) * cos(x(2)) * s2y) * m2 * l1;];
B = [1 0; 0 1;];

% ref state
xR = interp1(traj.t, traj.x', t)';
xiR = interp1(traj.t, traj.xi', t)';
xiRd = interp1(traj.t, traj.xid', t)';

if ((param.CtrlMode == 1) || (param.CtrlMode == 3))
  J1c   = 1;
  sig1c = J1c * 2*param.zetac*param.w0c;
  kap1c = J1c * param.w0c^2;
  J2c   = 1;
  sig2c = J2c * 2*param.zetac*param.w0c;
  kap2c = J2c * param.w0c^2;
  Mc = [J1c 0; 0 J2c;];
  fc = [-J1c * xiRd(1) + sig1c * (xi(1) - xiR(1)) + sin(-xR(1) + x(1)) * kap1c; -J2c * xiRd(2) + sig2c * (xi(2) - xiR(2)) + sin(-xR(2) + x(2)) * kap2c;];
  Tc = (xi(1) / 0.2e1 - xiR(1) / 0.2e1) * J1c * (xi(1) - xiR(1)) + (xi(2) / 0.2e1 - xiR(2) / 0.2e1) * J2c * (xi(2) - xiR(2));
  Vc = -(cos(xR(1)) * cos(x(1)) + sin(xR(1)) * sin(x(1)) - 0.1e1) * kap1c - (cos(xR(2)) * cos(x(2)) + sin(xR(2)) * sin(x(2)) - 0.1e1) * kap2c;
  Pc = (xi(1) / 0.2e1 - xiR(1) / 0.2e1) * sig1c * (xi(1) - xiR(1)) + (xi(2) / 0.2e1 - xiR(2) / 0.2e1) * sig2c * (xi(2) - xiR(2));
elseif (param.CtrlMode == 2)
  J1c   = 1;
  sig1c = J1c * 2*param.zetac*param.w0c;
  kap1c = J1c * param.w0c^2;
  J2c   = 1;
  sig2c = J2c * 2*param.zetac*param.w0c;
  kap2c = J2c * param.w0c^2;
  Mc = [J1c 0; 0 J2c;];
  fc = [(-xiR(1) ^ 2 * sin(-xR(1) + x(1)) - xiRd(1) * cos(-xR(1) + x(1))) * J1c + (-xiR(1) * cos(-xR(1) + x(1)) + xi(1)) * sig1c + sin(-xR(1) + x(1)) * kap1c; (-xiR(2) ^ 2 * sin(-xR(2) + x(2)) - xiRd(2) * cos(-xR(2) + x(2))) * J2c + (-xiR(2) * cos(-xR(2) + x(2)) + xi(2)) * sig2c + sin(-xR(2) + x(2)) * kap2c;];
  Tc = -J1c * (0.2e1 * sin(x(1)) * sin(xR(1)) * xi(1) * xiR(1) + 0.2e1 * cos(x(1)) * cos(xR(1)) * xi(1) * xiR(1) - xi(1) ^ 2 - xiR(1) ^ 2) / 0.2e1 - J2c * (0.2e1 * cos(x(2)) * cos(xR(2)) * xi(2) * xiR(2) + 0.2e1 * sin(x(2)) * sin(xR(2)) * xi(2) * xiR(2) - xi(2) ^ 2 - xiR(2) ^ 2) / 0.2e1;
  Vc = -(cos(xR(1)) * cos(x(1)) + sin(xR(1)) * sin(x(1)) - 0.1e1) * kap1c - (cos(xR(2)) * cos(x(2)) + sin(xR(2)) * sin(x(2)) - 0.1e1) * kap2c;
  Pc = -sig1c * (0.2e1 * sin(x(1)) * sin(xR(1)) * xi(1) * xiR(1) + 0.2e1 * cos(x(1)) * cos(xR(1)) * xi(1) * xiR(1) - xi(1) ^ 2 - xiR(1) ^ 2) / 0.2e1 - sig2c * (0.2e1 * cos(x(2)) * cos(xR(2)) * xi(2) * xiR(2) + 0.2e1 * sin(x(2)) * sin(xR(2)) * xi(2) * xiR(2) - xi(2) ^ 2 - xiR(2) ^ 2) / 0.2e1;
elseif ((param.CtrlMode == 4) || (param.CtrlMode == 5))
  m2c = 160;
  d2c = m2c * 2*param.zetac*param.w0c;
  k2c = m2c * param.w0c^2;
  Mc = [m2c * (0.4e1 * cos(x(2)) * l1 * l2 + 0.2e1 * l2 ^ 2 + 0.2e1 * l1 ^ 2) / 0.2e1 m2c * (0.2e1 * cos(x(2)) * l1 * l2 + 0.2e1 * l2 ^ 2) / 0.2e1; m2c * (0.2e1 * cos(x(2)) * l1 * l2 + 0.2e1 * l2 ^ 2) / 0.2e1 l2 ^ 2 * m2c;];
  fc = [m2c * (-0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xiR(2) - sin(x(2)) * l1 * l2 * xi(2) ^ 2 + sin(xR(1)) * cos(x(1)) * l1 ^ 2 * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * l1 ^ 2 * xiRd(1) - cos(xR(1)) * sin(x(1)) * l1 ^ 2 * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * l1 ^ 2 * xiRd(1) - 0.2e1 * sin(x(2)) * l1 * l2 * xi(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiRd(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xiRd(1) - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiRd(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(2) + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiR(2) ^ 2 - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiRd(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(2) + sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiRd(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiRd(2) + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(2) + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 * xiR(2) ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(1) + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiRd(2) - cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xiRd(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xiRd(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiRd(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiRd(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiRd(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiRd(2)) + d2c * (0.4e1 * cos(x(2)) * l1 * l2 * xi(1) + 0.2e1 * cos(x(2)) * l1 * l2 * xi(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * l1 ^ 2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * l1 ^ 2 * xiR(1) + 0.2e1 * l2 ^ 2 * xi(1) + 0.2e1 * l2 ^ 2 * xi(2) + 0.2e1 * l1 ^ 2 * xi(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1)) / 0.2e1 + k2c * (cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 + sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 + cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 + sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 - sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 + cos(xR(1)) * sin(x(1)) * l1 ^ 2 - sin(xR(1)) * cos(x(1)) * l1 ^ 2); m2c * l2 * (sin(x(2)) * l1 * xi(1) ^ 2 - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiR(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiR(1) * xiR(2) - cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * xiR(1) ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * xiRd(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * xiRd(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiRd(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiRd(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiRd(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiRd(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiRd(2) - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiR(2) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiR(2) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiR(2) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiR(2) ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiRd(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 * xiRd(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 * xiRd(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 * xiRd(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 * xiRd(2)) + d2c * (0.2e1 * l2 ^ 2 * xi(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) + 0.2e1 * cos(x(2)) * l1 * l2 * xi(1) + 0.2e1 * l2 ^ 2 * xi(2)) / 0.2e1 + k2c * (cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 + sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 + sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 - l1 * l2 * sin(x(2)));];
  Tc = m2c * (0.2e1 * cos(x(2)) * l1 * l2 * xi(1) * xi(2) + 0.2e1 * cos(xR(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * l1 ^ 2 * xi(1) * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) * xi(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(2) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xi(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * l1 ^ 2 * xi(1) * xiR(1) + l1 ^ 2 * xiR(1) ^ 2 + l1 ^ 2 * xi(1) ^ 2 + l2 ^ 2 * xi(1) ^ 2 + l2 ^ 2 * xi(2) ^ 2 + l2 ^ 2 * xiR(2) ^ 2 + l2 ^ 2 * xiR(1) ^ 2 + 0.2e1 * cos(xR(2)) * l1 * l2 * xiR(1) ^ 2 + 0.2e1 * cos(x(2)) * l1 * l2 * xi(1) ^ 2 + 0.2e1 * l2 ^ 2 * xiR(1) * xiR(2) + 0.2e1 * l2 ^ 2 * xi(1) * xi(2)) / 0.2e1;
  Vc = k2c * (cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * l1 ^ 2 - sin(x(1)) * sin(xR(1)) * l1 ^ 2 + cos(xR(2)) * l1 * l2 + cos(x(2)) * l1 * l2 + l1 ^ 2 + l2 ^ 2);
  Pc = d2c * (0.2e1 * cos(x(2)) * l1 * l2 * xi(1) * xi(2) + 0.2e1 * cos(xR(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * l1 ^ 2 * xi(1) * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) * xi(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * xi(2) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(1) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xiR(1) * xi(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * xi(2) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xiR(1) * xi(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * xi(2) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(1) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(1) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xi(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(1) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * l1 ^ 2 * xi(1) * xiR(1) + l1 ^ 2 * xiR(1) ^ 2 + l1 ^ 2 * xi(1) ^ 2 + l2 ^ 2 * xi(1) ^ 2 + l2 ^ 2 * xi(2) ^ 2 + l2 ^ 2 * xiR(2) ^ 2 + l2 ^ 2 * xiR(1) ^ 2 + 0.2e1 * cos(xR(2)) * l1 * l2 * xiR(1) ^ 2 + 0.2e1 * cos(x(2)) * l1 * l2 * xi(1) ^ 2 + 0.2e1 * l2 ^ 2 * xiR(1) * xiR(2) + 0.2e1 * l2 ^ 2 * xi(1) * xi(2)) / 0.2e1;
elseif (param.CtrlMode == 6)
  m2c = 1;
  d2c = m2c * 2*param.zetac*param.w0c;
  k2c = m2c * param.w0c^2;
  Mc = [m2c * (0.4e1 * cos(x(2)) * l1 * l2 + 0.2e1 * l2 ^ 2 + 0.2e1 * l1 ^ 2) / 0.2e1 m2c * (0.2e1 * cos(x(2)) * l1 * l2 + 0.2e1 * l2 ^ 2) / 0.2e1; m2c * (0.2e1 * cos(x(2)) * l1 * l2 + 0.2e1 * l2 ^ 2) / 0.2e1 l2 ^ 2 * m2c;];
  fc = [-m2c * (cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 * xiR(2) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(2) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 * xiR(2) ^ 2 - sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(2) ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiRd(2) + cos(xR(1)) * sin(x(1)) * l1 ^ 2 * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiRd(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiRd(2) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiRd(2) - sin(xR(1)) * cos(x(1)) * l1 ^ 2 * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * l1 ^ 2 * xiRd(2) - sin(x(1)) * sin(xR(1)) * l1 ^ 2 * xiRd(2) + 0.2e1 * sin(x(2)) * l1 * l2 * xi(1) * xi(2) - 0.2e1 * sin(x(2)) * l1 * l2 * xiR(1) * xi(2) + sin(x(2)) * l1 * l2 * xi(2) ^ 2 - 0.2e1 * sin(x(2)) * l1 * l2 * xi(2) * xiR(2) + 0.2e1 * cos(x(2)) * l1 * l2 * xiRd(1) + 0.2e1 * cos(x(2)) * l1 * l2 * xiRd(2) + l1 ^ 2 * xiRd(1) + l1 ^ 2 * xiRd(2) + l2 ^ 2 * xiRd(1) + l2 ^ 2 * xiRd(2)) - d2c * (-0.2e1 * cos(xR(1)) * cos(x(1)) * l1 ^ 2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * l1 ^ 2 * xiR(2) + 0.4e1 * cos(x(2)) * l1 * l2 * xiR(1) + 0.4e1 * cos(x(2)) * l1 * l2 * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * l1 ^ 2 * xi(1) - 0.2e1 * l2 ^ 2 * xi(2) + 0.2e1 * l2 ^ 2 * xiR(1) + 0.2e1 * l2 ^ 2 * xiR(2) - 0.2e1 * cos(x(2)) * l1 * l2 * xi(2) - 0.2e1 * l2 ^ 2 * xi(1) + 0.2e1 * l1 ^ 2 * xiR(1) - 0.4e1 * cos(x(2)) * l1 * l2 * xi(1) + 0.2e1 * l1 ^ 2 * xiR(2)) / 0.2e1 + k2c * (cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 + sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 + cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 + sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 - sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 + cos(xR(1)) * sin(x(1)) * l1 ^ 2 - sin(xR(1)) * cos(x(1)) * l1 ^ 2); -m2c * l2 * (cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * xiR(2) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * xiR(2) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * xiR(2) ^ 2 - sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * xiR(2) ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * xiRd(2) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * xiRd(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * xiRd(2) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * xiRd(2) - sin(x(2)) * l1 * xi(1) ^ 2 + 0.2e1 * sin(x(2)) * l1 * xi(1) * xiR(1) + 0.2e1 * sin(x(2)) * l1 * xi(1) * xiR(2) - sin(x(2)) * l1 * xiR(1) ^ 2 - 0.2e1 * sin(x(2)) * l1 * xiR(1) * xiR(2) - sin(x(2)) * l1 * xiR(2) ^ 2 + cos(x(2)) * l1 * xiRd(1) + cos(x(2)) * l1 * xiRd(2) + l2 * xiRd(1) + l2 * xiRd(2)) - d2c * (0.2e1 * cos(x(2)) * l1 * l2 * xiR(1) + 0.2e1 * cos(x(2)) * l1 * l2 * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(2) - 0.2e1 * l2 ^ 2 * xi(1) + 0.2e1 * l2 ^ 2 * xiR(1) + 0.2e1 * l2 ^ 2 * xiR(2) - 0.2e1 * cos(x(2)) * l1 * l2 * xi(1) - 0.2e1 * l2 ^ 2 * xi(2)) / 0.2e1 + k2c * (cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 + sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 + sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 - l1 * l2 * sin(x(2)));];
  Tc = -m2c * ((2 * l2 ^ 2 * xi(1) * xiR(2)) + (2 * l2 ^ 2 * xi(1) * xiR(1)) + (2 * l2 ^ 2 * xiR(1) * xi(2)) + (2 * l2 ^ 2 * xi(2) * xiR(2)) + (2 * l1 ^ 2 * xi(1) * xiR(1)) + (2 * l1 ^ 2 * xi(1) * xiR(2)) - (2 * l1 ^ 2 * xiR(1) * xiR(2)) - 0.2e1 * cos(x(2)) * l1 * l2 * xi(1) * xi(2) - (l1 ^ 2 * xiR(1) ^ 2) - (l1 ^ 2 * xi(1) ^ 2) - (l2 ^ 2 * xi(1) ^ 2) - (l2 ^ 2 * xi(2) ^ 2) - (l2 ^ 2 * xiR(2) ^ 2) - (l2 ^ 2 * xiR(1) ^ 2) - 0.2e1 * cos(x(2)) * l1 * l2 * (xi(1) ^ 2) - (2 * l1 ^ 2 * xiR(2) ^ 2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * (l1 ^ 2) * (xiR(2) ^ 2) - 0.2e1 * cos(x(2)) * l1 * l2 * (xiR(1) ^ 2) - 0.2e1 * cos(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * (l1 ^ 2) * (xiR(2) ^ 2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * (xiR(2) ^ 2) - (2 * l2 ^ 2 * xiR(1) * xiR(2)) - (2 * l2 ^ 2 * xi(1) * xi(2)) - 0.2e1 * cos(xR(1)) * cos(x(1)) * (l1 ^ 2) * xi(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * (l1 ^ 2) * xiR(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * (l1 ^ 2) * xi(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * (l1 ^ 2) * xiR(1) * xiR(2) + 0.4e1 * cos(x(2)) * l1 * l2 * xi(1) * xiR(1) + 0.4e1 * cos(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * cos(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.4e1 * cos(x(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * cos(x(2)) * l1 * l2 * xi(2) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xi(2) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xi(2) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xi(2) * xiR(2)) / 0.2e1;
  Vc = k2c * (cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 - cos(xR(1)) * cos(x(1)) * l1 ^ 2 - sin(x(1)) * sin(xR(1)) * l1 ^ 2 + cos(xR(2)) * l1 * l2 + cos(x(2)) * l1 * l2 + l1 ^ 2 + l2 ^ 2);
  Pc = -d2c * ((2 * l2 ^ 2 * xi(1) * xiR(2)) + (2 * l2 ^ 2 * xi(1) * xiR(1)) + (2 * l2 ^ 2 * xiR(1) * xi(2)) + (2 * l2 ^ 2 * xi(2) * xiR(2)) + (2 * l1 ^ 2 * xi(1) * xiR(1)) + (2 * l1 ^ 2 * xi(1) * xiR(2)) - (2 * l1 ^ 2 * xiR(1) * xiR(2)) - 0.2e1 * cos(x(2)) * l1 * l2 * xi(1) * xi(2) - (l1 ^ 2 * xiR(1) ^ 2) - (l1 ^ 2 * xi(1) ^ 2) - (l2 ^ 2 * xi(1) ^ 2) - (l2 ^ 2 * xi(2) ^ 2) - (l2 ^ 2 * xiR(2) ^ 2) - (l2 ^ 2 * xiR(1) ^ 2) - 0.2e1 * cos(x(2)) * l1 * l2 * (xi(1) ^ 2) - (2 * l1 ^ 2 * xiR(2) ^ 2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * (l1 ^ 2) * (xiR(2) ^ 2) - 0.2e1 * cos(x(2)) * l1 * l2 * (xiR(1) ^ 2) - 0.2e1 * cos(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * (l1 ^ 2) * (xiR(2) ^ 2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * (xiR(2) ^ 2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * (xiR(2) ^ 2) - (2 * l2 ^ 2 * xiR(1) * xiR(2)) - (2 * l2 ^ 2 * xi(1) * xi(2)) - 0.2e1 * cos(xR(1)) * cos(x(1)) * (l1 ^ 2) * xi(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * (l1 ^ 2) * xiR(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * (l1 ^ 2) * xi(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * (l1 ^ 2) * xiR(1) * xiR(2) + 0.4e1 * cos(x(2)) * l1 * l2 * xi(1) * xiR(1) + 0.4e1 * cos(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * cos(x(2)) * l1 * l2 * xiR(1) * xi(2) - 0.4e1 * cos(x(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * cos(x(2)) * l1 * l2 * xi(2) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * xi(2) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * xi(2) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * xi(2) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xi(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xiR(1) * xiR(2) - 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * xi(2) * xiR(2)) / 0.2e1;
elseif (param.CtrlMode == 8)
  m2c = 1;
  d2c = m2c * 2*param.zetac*param.w0c;
  k2c = m2c * param.w0c^2;
  J2c = 1/12 * m2c*l2*l2/2;
  sig2c = 0;
  kap2c = 0;
  Mc = [l2 ^ 2 * m2c + l1 ^ 2 * m2c + 0.2e1 * cos(x(2)) * l1 * l2 * m2c + J2c J2c + cos(x(2)) * l1 * l2 * m2c + l2 ^ 2 * m2c; J2c + cos(x(2)) * l1 * l2 * m2c + l2 ^ 2 * m2c l2 ^ 2 * m2c + J2c;];
  fc = [-sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * d2c * l1 * l2 * xiR(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * d2c * l1 * l2 * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) + cos(xR(1)) * sin(x(1)) * sin(x(2)) * d2c * l1 * l2 * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * d2c * l1 * l2 * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(2) + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 - 0.2e1 * J2c * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) - 0.2e1 * J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) - 0.2e1 * J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) - 0.2e1 * J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * m2c * xiRd(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) - cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) + sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiRd(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * d2c * l1 * l2 * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * d2c * l1 * l2 * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * d2c * l1 * l2 * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * d2c * l1 * l2 * xiR(1) + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * m2c * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * m2c * xiRd(2) - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiRd(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiRd(2) + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiR(2) ^ 2 + d2c * l2 ^ 2 * xi(1) + d2c * l2 ^ 2 * xi(2) + d2c * l1 ^ 2 * xi(1) + cos(xR(1)) * sin(x(1)) * k2c * l1 ^ 2 - cos(x(1)) * sin(xR(1)) * k2c * l1 ^ 2 - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xiRd(1) - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xiRd(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(1) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(2) - J2c * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(2) ^ 2 + J2c * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) ^ 2 + J2c * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(2) ^ 2 - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) ^ 2 + J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) ^ 2 + J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(2) ^ 2 - cos(x(1)) * sin(xR(1)) * cos(x(2)) * k2c * l1 * l2 + sin(xR(1)) * sin(x(1)) * sin(x(2)) * k2c * l1 * l2 - sin(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * k2c * l1 * l2 + cos(xR(1)) * sin(x(1)) * cos(x(2)) * k2c * l1 * l2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * k2c * l2 ^ 2 - cos(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 - cos(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * k2c * l2 ^ 2 + sin(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) ^ 2 + J2c * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(1) - J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) ^ 2 - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(2) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiRd(1) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiRd(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xiRd(1) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xiRd(2) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(1) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(2) + J2c * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) ^ 2 + J2c * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * xiR(2) ^ 2 + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(1) + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiRd(1) - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiRd(2) - sin(xR(1)) * sin(x(1)) * sin(xR(2)) * k2c * l1 * l2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * k2c * l1 * l2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * k2c * l1 * l2 - cos(x(1)) * sin(xR(1)) * cos(xR(2)) * k2c * l1 * l2 - 0.2e1 * sin(x(2)) * l1 * l2 * m2c * xi(1) * xi(2) + 0.2e1 * cos(x(2)) * d2c * l1 * l2 * xi(1) + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * kap2c - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * kap2c + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * kap2c + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * kap2c - cos(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * kap2c - cos(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * kap2c + sin(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * kap2c - sin(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * kap2c - sin(x(2)) * l1 * l2 * m2c * xi(2) ^ 2 + sin(xR(1)) * cos(x(1)) * l1 ^ 2 * m2c * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * l1 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * l1 ^ 2 * m2c * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * l1 ^ 2 * m2c * xiRd(1) + cos(x(2)) * d2c * l1 * l2 * xi(2) - cos(xR(1)) * cos(x(1)) * d2c * l1 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * d2c * l1 ^ 2 * xiR(1) - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * l1 * l2 * m2c * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xiR(1) * xiR(2) + sig2c * xi(2) + sig2c * xi(1); -sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * d2c * l1 * l2 * xiR(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * d2c * l1 * l2 * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(2) + cos(xR(1)) * sin(x(1)) * sin(x(2)) * d2c * l1 * l2 * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * d2c * l1 * l2 * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(2) + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 - cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) ^ 2 - 0.2e1 * J2c * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) - 0.2e1 * J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) - 0.2e1 * J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) - 0.2e1 * J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) * xiR(2) + 0.2e1 * J2c * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * m2c * xiRd(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) - cos(xR(1)) * sin(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) + sin(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiRd(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiRd(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiRd(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiRd(1) - cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(2) ^ 2 + d2c * l2 ^ 2 * xi(1) + d2c * l2 ^ 2 * xi(2) - sin(x(2)) * k2c * l1 * l2 - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xiRd(1) - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xiRd(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(1) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(2) - J2c * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(2) ^ 2 + J2c * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) ^ 2 + J2c * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(2) ^ 2 - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) ^ 2 + J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) ^ 2 + J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(2) ^ 2 - cos(x(1)) * sin(xR(1)) * cos(x(2)) * k2c * l1 * l2 + sin(xR(1)) * sin(x(1)) * sin(x(2)) * k2c * l1 * l2 - sin(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * sin(x(2)) * k2c * l1 * l2 + cos(xR(1)) * sin(x(1)) * cos(x(2)) * k2c * l1 * l2 - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * k2c * l2 ^ 2 - cos(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 - cos(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * k2c * l2 ^ 2 + sin(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) ^ 2 + J2c * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(1) - J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) ^ 2 - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xiRd(2) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiRd(1) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiRd(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xiRd(1) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xiRd(2) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(1) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(2) + J2c * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) ^ 2 + J2c * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * xiR(2) ^ 2 + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(1) + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xiRd(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * xiR(2) ^ 2 - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiRd(1) - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiRd(2) + sin(x(2)) * l1 * l2 * m2c * xi(1) ^ 2 + cos(x(2)) * d2c * l1 * l2 * xi(1) + cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * kap2c - cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * kap2c + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * kap2c + cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * kap2c - cos(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * kap2c - cos(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * kap2c + sin(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * kap2c - sin(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * kap2c - 0.2e1 * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(x(1)) * sin(xR(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * cos(xR(1)) * sin(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + 0.2e1 * cos(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) - 0.2e1 * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) * xiR(2) + sig2c * xi(2) + sig2c * xi(1);];
  Tc = J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) * xi(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xi(1) * xiR(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xi(2) * xiR(2) - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xi(1) * xiR(1) - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xiR(1) * xi(2) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xi(1) * xiR(1) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) * xi(2) - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xi(1) * xiR(2) - J2c * cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * xi(2) * xiR(2) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xi(1) * xiR(2) - J2c * cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * xi(2) * xiR(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xi(1) * xiR(1) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xi(1) * xiR(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) * xi(2) - J2c * sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * xi(2) * xiR(2) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xi(1) * xiR(1) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) * xi(2) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xi(1) * xiR(2) - J2c * sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * xi(2) * xiR(2) + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xi(1) * xiR(1) + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xiR(1) * xi(2) - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xi(1) * xiR(1) - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xiR(1) * xi(2) + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xi(1) * xiR(2) + J2c * cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * xi(2) * xiR(2) - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xi(1) * xiR(2) - J2c * cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * xi(2) * xiR(2) - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xi(1) * xiR(1) - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xi(1) * xiR(2) - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xiR(1) * xi(2) - J2c * sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * xi(2) * xiR(2) + J2c * sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * xi(1) * xiR(1) + cos(x(2)) * l1 * l2 * m2c * xi(1) ^ 2 + cos(xR(2)) * l1 * l2 * m2c * xiR(1) ^ 2 + cos(xR(2)) * l1 * l2 * m2c * xiR(1) * xiR(2) + cos(x(2)) * l1 * l2 * m2c * xi(1) * xi(2) - sin(x(1)) * sin(xR(1)) * l1 ^ 2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * l1 ^ 2 * m2c * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * m2c * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * l1 * l2 * m2c * xiR(1) * xi(2) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiR(1) * xi(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xiR(1) * xi(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(1) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * l2 ^ 2 * m2c * xi(2) * xiR(2) + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * m2c * xi(1) * xiR(1) + cos(xR(1)) * sin(x(1)) * sin(x(2)) * l1 * l2 * m2c * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * l1 * l2 * m2c * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * l1 * l2 * m2c * xi(1) * xiR(2) + l2 ^ 2 * m2c * xi(2) ^ 2 / 0.2e1 + l2 ^ 2 * m2c * xiR(1) ^ 2 / 0.2e1 + l2 ^ 2 * m2c * xiR(2) ^ 2 / 0.2e1 + l2 ^ 2 * m2c * xi(1) ^ 2 / 0.2e1 + J2c * xi(1) * xi(2) + J2c * xiR(1) * xiR(2) + l1 ^ 2 * m2c * xi(1) ^ 2 / 0.2e1 + l1 ^ 2 * m2c * xiR(1) ^ 2 / 0.2e1 + l2 ^ 2 * m2c * xi(1) * xi(2) + l2 ^ 2 * m2c * xiR(1) * xiR(2) + J2c * xi(1) ^ 2 / 0.2e1 + J2c * xi(2) ^ 2 / 0.2e1 + J2c * xiR(1) ^ 2 / 0.2e1 + J2c * xiR(2) ^ 2 / 0.2e1;
  Vc = cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * k2c * l2 ^ 2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * k2c * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * k2c * l2 ^ 2 - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * k2c * l2 ^ 2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * k2c * l2 ^ 2 + cos(xR(1)) * sin(x(1)) * sin(x(2)) * k2c * l1 * l2 - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * k2c * l1 * l2 - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * k2c * l1 * l2 - cos(xR(1)) * cos(x(1)) * cos(x(2)) * k2c * l1 * l2 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * k2c * l1 * l2 - sin(x(1)) * sin(xR(1)) * cos(x(2)) * k2c * l1 * l2 - sin(xR(1)) * cos(x(1)) * sin(x(2)) * k2c * l1 * l2 + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * k2c * l1 * l2 + k2c * l1 ^ 2 + cos(xR(2)) * k2c * l1 * l2 + cos(x(2)) * k2c * l1 * l2 - cos(xR(1)) * cos(x(1)) * k2c * l1 ^ 2 - sin(x(1)) * sin(xR(1)) * k2c * l1 ^ 2 + kap2c + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * kap2c - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * kap2c - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * kap2c - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * kap2c - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * kap2c - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * kap2c - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * kap2c + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * kap2c + l2 ^ 2 * k2c;
  Pc = cos(x(2)) * d2c * l1 * l2 * xi(1) ^ 2 + cos(xR(2)) * d2c * l1 * l2 * xiR(1) ^ 2 + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xi(1) * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(1) * xi(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xi(1) * xiR(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xi(2) * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xi(2) * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(1) * xi(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xi(2) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(1) * xi(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xi(2) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xiR(1) * xi(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * sig2c * xi(2) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * sig2c * xi(2) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xiR(1) * xi(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * sig2c * xi(2) * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xi(1) * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xiR(1) * xi(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xi(1) * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * sig2c * xi(2) * xiR(2) + cos(xR(2)) * d2c * l1 * l2 * xiR(1) * xiR(2) + cos(x(2)) * d2c * l1 * l2 * xi(1) * xi(2) - cos(xR(1)) * cos(x(1)) * d2c * l1 ^ 2 * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * d2c * l1 ^ 2 * xi(1) * xiR(1) + d2c * l2 ^ 2 * xiR(2) ^ 2 / 0.2e1 + d2c * l2 ^ 2 * xiR(1) ^ 2 / 0.2e1 + d2c * l2 ^ 2 * xi(2) ^ 2 / 0.2e1 + d2c * l2 ^ 2 * xi(1) ^ 2 / 0.2e1 + d2c * l1 ^ 2 * xi(1) ^ 2 / 0.2e1 + d2c * l1 ^ 2 * xiR(1) ^ 2 / 0.2e1 + sig2c * xiR(1) * xiR(2) + sig2c * xi(1) * xi(2) + sig2c * xiR(1) ^ 2 / 0.2e1 + sig2c * xi(1) ^ 2 / 0.2e1 + sig2c * xi(2) ^ 2 / 0.2e1 + sig2c * xiR(2) ^ 2 / 0.2e1 - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) + cos(xR(1)) * sin(x(1)) * sin(x(2)) * d2c * l1 * l2 * xi(1) * xiR(1) + cos(xR(1)) * sin(x(1)) * sin(x(2)) * d2c * l1 * l2 * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * d2c * l1 * l2 * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(x(2)) * d2c * l1 * l2 * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * d2c * l1 * l2 * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * cos(x(2)) * d2c * l1 * l2 * xiR(1) * xi(2) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * d2c * l1 * l2 * xi(1) * xiR(1) - sin(xR(1)) * cos(x(1)) * sin(x(2)) * d2c * l1 * l2 * xiR(1) * xi(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) + cos(xR(1)) * sin(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) - sin(x(1)) * sin(xR(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) - sin(x(1)) * sin(xR(1)) * cos(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(2) - sin(xR(1)) * cos(x(1)) * cos(xR(2)) * sin(x(2)) * d2c * l2 ^ 2 * xi(2) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(2) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) - cos(xR(1)) * sin(x(1)) * sin(xR(2)) * cos(x(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xi(1) * xiR(1) - cos(xR(1)) * cos(x(1)) * sin(x(2)) * sin(xR(2)) * d2c * l2 ^ 2 * xiR(1) * xi(2) - cos(xR(1)) * cos(x(1)) * cos(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(2) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(1) + sin(xR(1)) * cos(x(1)) * sin(xR(2)) * d2c * l1 * l2 * xi(1) * xiR(2) + d2c * l2 ^ 2 * xi(1) * xi(2) + d2c * l2 ^ 2 * xiR(1) * xiR(2);
end

Ba = M\B;
u = (Ba'*Mc*Ba) \ (Ba'*(Mc*(M\f) - fc));
Wc = Tc + Vc;

