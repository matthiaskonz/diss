\section{Kinetics}
Kinetics is the the part of mechanics that relates motion to its causes, i.e.\ forces.%\cite[p.\ 6]{Hamel:TheoretischeMechanik}
In the previous section we derived the \textit{kinetic equation} \eqref{eq:PrinciplesForceBalance} as a balance of generalized inertia force $\genForceInertiaCoeff{\LidxI} = \sumParticles \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{-\particleMass{\PidxI}\particlePosdd{\PidxI}}$ and the generalized applied force $\genForceImpressedCoeff{\LidxI} = \sumParticles \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particleForceImpressed{\PidxI}}$.
The applied force $\particleForceImpressed{\PidxI}$ sums all forces on the particle that are not due to inertia or constraints.
For the following we split it as $\particleForceImpressed{\PidxI} = \particleForceDiss{\PidxI} + \particleForceStiff{\PidxI} + \particleForceGravity{\PidxI} + \particleForceEx{\PidxI}$ into dissipative force $\particleForceDiss{\PidxI}$, force originating from springs $\particleForceStiff{\PidxI}$, gravitational force $\particleForceGravity{\PidxI}$, and $\particleForceEx{\PidxI}$ collects everything else, e.g.\ control forces.

\subsection{Inertia}
Expressing the particle accelerations $\particlePosdd{\PidxI}$ in terms of the velocity coordinates $\sysVel$ and rearranging some terms we find
\begin{align}
 -\genForceInertiaCoeff{\LidxI}
 &= \sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\overbrace{\dirDiff{\LidxII} \particlePos{\PidxI} \sysVelCoeffd{\LidxII} + \dirDiff{\LidxIII} \dirDiff{\LidxII} \particlePos{\PidxI} \sysVelCoeff{\LidxIII} \sysVelCoeff{\LidxII}}^{\particlePosdd{\PidxI}}}
\nonumber\\
 &= \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\dirDiff{\LidxII} \particlePos{\PidxI}}}_{\sysInertiaMatCoeff{\LidxI\LidxII}} \sysVelCoeffd{\LidxII}
 + \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\dirDiff{\LidxIII} \dirDiff{\LidxII} \particlePos{\PidxI}}}_{\ConnCoeffL{\LidxI}{\LidxII}{\LidxIII}} \sysVelCoeff{\LidxIII} \sysVelCoeff{\LidxII}
\end{align}
where we introduced the \textit{system inertia matrix} $\sysInertiaMat(\sysCoord) \in \RealNum^{\dimConfigSpace\times\dimConfigSpace}$ and the \textit{connection coefficients} $\mat{\ConnCoeffSym}(\sysCoord) \in \RealNum^{\dimConfigSpace\times\dimConfigSpace\times\dimConfigSpace}$.
These are related by the following identities
\begin{subequations}
\begin{align}
 \label{eq:ConnCoeffSymOne}
 \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII}
 &= \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\dirDiff{\LidxIII} \dirDiff{\LidxII} \particlePos{\PidxI}}}_{\ConnCoeffL{\LidxI}{\LidxII}{\LidxIII}}
 + \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxIII} \dirDiff{\LidxI} \particlePos{\PidxI}}{\dirDiff{\LidxII} \particlePos{\PidxI}}}_{\ConnCoeffL{\LidxII}{\LidxI}{\LidxIII}}
\\ 
 \label{eq:ConnCoeffSymTwo}
 \BoltzSym{\LidxV}{\LidxI}{\LidxII} \sysInertiaMatCoeff{\LidxV\LidxIII}
 &= \sumParticles \particleMass{\PidxI} \sProd{\BoltzSym{\LidxV}{\LidxI}{\LidxII} \partial_\LidxV \particlePos{\PidxI}}{\dirDiff{\LidxIII} \particlePos{\PidxI}}
 = \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \dirDiff{\LidxII} \particlePos{\PidxI}}{\dirDiff{\LidxIII} \particlePos{\PidxI}}}_{\ConnCoeffL{\LidxIII}{\LidxII}{\LidxI}}
 - \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxII} \dirDiff{\LidxI} \particlePos{\PidxI}}{\dirDiff{\LidxIII} \particlePos{\PidxI}}}_{\ConnCoeffL{\LidxIII}{\LidxI}{\LidxII}}
\end{align} 
\end{subequations}
Plugging these together while permuting the indices, we find
\begin{align}
 \ConnCoeffL{\LidxI}{\LidxII}{\LidxIII} &= \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} - \ConnCoeffL{\LidxII}{\LidxI}{\LidxIII} 
\nonumber\\
 &= \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxII} - \ConnCoeffL{\LidxII}{\LidxIII}{\LidxI} 
\nonumber\\
 &= \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxII} - \dirDiff{\LidxI} \sysInertiaMatCoeff{\LidxIII\LidxII} + \ConnCoeffL{\LidxIII}{\LidxII}{\LidxI}
\nonumber\\
 &= \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxII} - \dirDiff{\LidxI} \sysInertiaMatCoeff{\LidxIII\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxII} \sysInertiaMatCoeff{\LidxV\LidxIII} + \ConnCoeffL{\LidxIII}{\LidxI}{\LidxII}
\nonumber\\
 &= \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxII} - \dirDiff{\LidxI} \sysInertiaMatCoeff{\LidxIII\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxII} \sysInertiaMatCoeff{\LidxV\LidxIII} + \dirDiff{\LidxII} \sysInertiaMatCoeff{\LidxI\LidxIII} - \ConnCoeffL{\LidxI}{\LidxIII}{\LidxII}
\nonumber\\
 &= \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxII} - \dirDiff{\LidxI} \sysInertiaMatCoeff{\LidxIII\LidxII} + \BoltzSym{\LidxV}{\LidxI}{\LidxII} \sysInertiaMatCoeff{\LidxV\LidxIII} + \dirDiff{\LidxII} \sysInertiaMatCoeff{\LidxI\LidxIII} - \BoltzSym{\LidxV}{\LidxIII}{\LidxII} \sysInertiaMatCoeff{\LidxV\LidxI} - \ConnCoeffL{\LidxI}{\LidxII}{\LidxIII}
\\[1ex]
 \Leftrightarrow \quad
 \ConnCoeffL{\LidxI}{\LidxII}{\LidxIII} &= \tfrac{1}{2}\big( \dirDiff{\LidxIII} \sysInertiaMatCoeff{\LidxI\LidxII} + \dirDiff{\LidxII} \sysInertiaMatCoeff{\LidxI\LidxIII} - \dirDiff{\LidxI} \sysInertiaMatCoeff{\LidxII\LidxIII} + \BoltzSym{\LidxV}{\LidxI}{\LidxII} \sysInertiaMatCoeff{\LidxV\LidxIII} + \BoltzSym{\LidxV}{\LidxI}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxII} - \BoltzSym{\LidxV}{\LidxII}{\LidxIII} \sysInertiaMatCoeff{\LidxV\LidxI} \big).
\end{align}
This means the connection coefficients are determined by the inertia matrix $\sysInertiaMat$ and the geometric matrix $\kinMat$ which also determines the commutation coefficients $\mat{\BoltzSymSym}$.

\paragraph{Lagrange formulation.}
With some reordering and using the relations \eqref{eq:DefCommutationCoeff} and \eqref{eq:IdentityDifferentials} we can write the inertial force as 
\begin{align}\label{eq:MyLagrangeEq}
 -\genForceInertiaCoeff{\LidxI}
 &= \sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particlePosdd{\PidxI}}
\nonumber\\
 &= \sumParticles \particleMass{\PidxI} \Big( \diff{t} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particlePosd{\PidxI}} - \sProd{\diff{t} \big(\dirDiff{\LidxI} \particlePos{\PidxI}\big)}{\particlePosd{\PidxI}} \Big)
\nonumber\\
 &= \sumParticles \particleMass{\PidxI} \Big( \diff{t} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particlePosd{\PidxI}} + \sProd{\BoltzSym{\LidxIII}{\LidxI}{\LidxII} \sysVelCoeff{\LidxII} \dirDiff{\LidxIII} \particlePos{\PidxI}}{\particlePosd{\PidxI}} - \sProd{\dirDiff{\LidxI} \particlePosd{\PidxI}}{\particlePosd{\PidxI}} \Big)
\nonumber\\
 &= \sumParticles \particleMass{\PidxI} \Big( \diff{t} \sProd{\pdiff[\particlePosd{\PidxI}]{\sysVelCoeff{\LidxI}}}{\particlePosd{\PidxI}} + \BoltzSym{\LidxIII}{\LidxI}{\LidxII} \sysVelCoeff{\LidxII} \sProd{\pdiff[\particlePosd{\PidxI}]{\sysVelCoeff{\LidxIII}}}{\particlePosd{\PidxI}} - \sProd{\dirDiff{\LidxI} \particlePosd{\PidxI}}{\particlePosd{\PidxI}} \Big)
\nonumber\\
 &= \Big( \diff{t} \pdiff{\sysVelCoeff{\LidxI}} + \BoltzSym{\LidxIII}{\LidxI}{\LidxII} \sysVelCoeff{\LidxII} \pdiff{\sysVelCoeff{\LidxIII}} - \dirDiff{\LidxI} \Big) \underbrace{\left(\tfrac{1}{2} \sumParticles \particleMass{\PidxI} \norm{\particlePosd{\PidxI}}^2 \right)}_{\kineticEnergy}, 
\qquad \LidxI = 1,\ldots,\dimConfigSpace
\end{align}
with the kinetic energy $\kineticEnergy$.
The derivation is essentially what was done in \eqref{eq:CalculationLagrangeToInertiaForce} backwards.
The formulation \eqref{eq:MyLagrangeEq} is a slight generalization of the ``classical`` Lagrange formulation \eqref{eq:LagrangeEq} allowing redundant configuration coordinates $\sysCoord$ and velocity coordinates $\sysVel$.
It is very similar to the formulations proposed in \cite{Boltzmann:NonholCoord} and \cite{Hamel:LagrangeEuler} up to the definition of the directional derivative $\dirDiff{\LidxI}$ and the commutation coefficients $\BoltzSym{\LidxIII}{\LidxI}{\LidxII}$ which therein restrict to \textit{minimal} configuration coordinates.

\paragraph{Gibbs-Appell formulation.}
Yet another formulation can be obtained using \eqref{eq:IdentityDifferentials}:
\begin{align}\label{eq:GibbsAppellEquations}
 -\genForceInertiaCoeff{\LidxI}
 &= \sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particlePosdd{\PidxI}}
\nonumber\\
 &= \sumParticles \particleMass{\PidxI} \sProd{\pdiff[\particlePosdd{\PidxI}]{\sysVelCoeffd{\LidxI}}}{\particlePosdd{\PidxI}}
\nonumber\\
 &= \pdiff{\sysVelCoeffd{\LidxI}} \underbrace{\left( \tfrac{1}{2} \sumParticles \particleMass{\PidxI} \norm{\particlePosdd{\PidxI}}^2 \right)}_{\accEnergy}
\qquad \LidxI = 1,\ldots,\dimConfigSpace
\end{align}
with the acceleration energy $\accEnergy$.
This formulation \eqref{eq:GibbsAppellEquations} was first proposed by \cite{Gibbs:FundamentalFormulaeOfDynamics} and by \cite{Appell:formeGenerale} with a focus on nonholonomic systems.


\subsection{Dissipation}\label{sec:ParticleSysDamping}

\cite[p.\ 24]{Goldstein:ClassicalMechanics} ''Frictional forces of this type may be derived in terms of a function, known as Rayleigh's dissipation function``

\cite[p.\ 519]{Papastavridis:AnalyticalMechanics} same as above

For dissipative forces we pick up the concept from \cite[ยง81]{Rayleigh:TheoryOfSound}: ''Suppose that each particle of the system is retarded by forces proportional to its component velocities``.
So for each particle we assume a damping force
\begin{align}
 \particleForceDiss{\PidxI} = -\particleDamping{\PidxI} \particlePosd{\PidxI},
% = \particleDamping{\PidxI} \dirDiff{\LidxI} \particlePos{\PidxI} \sysVelCoeff{\LidxI}, 
 \qquad \PidxI = 1,\ldots,\numParticles
\end{align}
with the damping parameters $\particleDamping{\PidxI} \in \RealNum^+$.
For a parameterized system \eqref{eq:ParticlePosParameterization} we have the \textit{generalized dissipation force}:
\begin{align}
 \genForceDissCoeff{\LidxI}
 = \sumParticles \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particleForceDiss{\PidxI}}
 = -\underbrace{\sumParticles \particleDamping{\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\dirDiff{\LidxII}\particlePos{\PidxI}}}_{\sysDissMatCoeff{\LidxI\LidxII}} \sysVelCoeff{\LidxII}
\end{align}
where we introduced the \textit{system dissipation matrix} $\sysDissMat(\sysCoord) \in \SymMatSP(\dimConfigSpace)$.
% \begin{align}
%  \genForceDissCoeff{\LidxI}
% % = \sumParticles \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{-\particleDamping{\PidxI} \particlePosd{\PidxI}}
%  = -\sumParticles \particleDamping{\PidxI} \sProd{\pdiff[\particlePosd{\PidxI}]{\sysVelCoeff{\LidxI}}}{ \particlePosd{\PidxI}}
%  = -\pdiff{\sysVelCoeff{\LidxI}} \underbrace{\sumParticles \tfrac{1}{2} \particleDamping{\PidxI} \norm{\particlePosd{\PidxI}}^2}_{\dissFkt}
% % = \pdiff{\sysVelCoeff{\LidxI}} \underbrace{\big( \tfrac{1}{2} \sysDissMatCoeff{\LidxI\LidxII} \sysVelCoeff{\LidxI} \sysVelCoeff{\LidxII} \big)}_{\dissFkt}
% \end{align}
Furthermore, these quantities can be derived from the so-called \textit{Rayleigh dissipation function} $\dissFkt: \Tangent\configSpace \rightarrow \RealNum$ using the rules \eqref{eq:IdentityDifferentials}:
\begin{align}
 \dissFkt &= \sumParticles \tfrac{1}{2} \particleDamping{\PidxI} \norm{\particlePosd{\PidxI}}^2 = \tfrac{1}{2} \sysDissMatCoeff{\LidxI\LidxII} \sysVelCoeff{\LidxI} \sysVelCoeff{\LidxII},&
 \genForceDissCoeff{\LidxI} &= -\pdiff[\dissFkt]{\sysVelCoeff{\LidxI}},&
 \sysDissMatCoeff{\LidxI\LidxII} &= \frac{\partial^2 \dissFkt}{\partial\sysVelCoeff{\LidxI} \partial\sysVelCoeff{\LidxII}}.
\end{align}
Note that the non-negativity of the damping parameters $\particleDamping{\PidxI} \geq 0, \PidxI=1,\ldots,\numParticles$ implies non-negativity of the dissipation function $\dissFkt \geq 0$ and positive semi-definiteness of the dissipation matrix $\sysDissMat \geq 0$.

General dissipation
\begin{align}
 \dissFkt &= \tfrac{1}{2} \sum_{\PidxI,\PidxII=1}^{\numParticles} \particleDamping{\PidxI\PidxII} \norm{\particlePosd{\PidxI} - \particlePosd{\PidxII}}^2
\\
 &= \tfrac{1}{2} \underbrace{\Big( \sum_{\PidxI,\PidxII=1}^{\numParticles} \particleDamping{\PidxI\PidxII} \sProd{\dirDiff{\LidxI}\particlePos{\PidxI} - \dirDiff{\LidxI}\particlePos{\PidxII}}{\dirDiff{\LidxII}\particlePos{\PidxI} - \dirDiff{\LidxII}\particlePos{\PidxII}} \Big)}_{\sysDissMatCoeff{\LidxI\LidxII}} \sysVelCoeff{\LidxII} \sysVelCoeff{\LidxI}
% \\
% &= \tfrac{1}{2} \sysVelCoeff{\LidxI} \sysVelCoeff{\LidxII} \sum_{\PidxI,\PidxII=1}^{\numParticles} \particleDamping{\PidxI\PidxII} \big( \sProd{\dirDiff{\LidxI}\particlePos{\PidxI}}{\dirDiff{\LidxII}\particlePos{\PidxI}} - 2\sProd{\dirDiff{\LidxI}\particlePos{\PidxI}}{\dirDiff{\LidxII}\particlePos{\PidxII}} + \sProd{\dirDiff{\LidxI}\particlePos{\PidxII}}{\dirDiff{\LidxII}\particlePos{\PidxII}} \big)
\end{align} 


\subsection{Linear springs}\label{sec:ParticleSysStiffness}
Assume that the particle with index $\PidxI$ is connected to another particle with index $\PidxII$ by a spring.
In the simplest case the resulting spring force obeys Hooke's law \cite{Hooke:OfSprings}: The force on particle $\PidxI$ connected by a spring, with the spring constant $\particleStiffness{\PidxI\PidxII} \in \RealNum^+$, to particle $\PidxII$ is 
\begin{align}
 \particleForceStiff{\PidxI\PidxII} &= \particleStiffness{\PidxI\PidxII} (\particlePos{\PidxII} - \particlePos{\PidxI}).
\end{align}
Naturally, the opposing force $\particleForceStiff{\PidxII\PidxI} = -\particleForceStiff{\PidxI\PidxII}$ acts on particle $\PidxII$.
For a particle system we can assume that each particle may be connected to each other particle and set $\particleStiffness{\PidxI\PidxII} = 0$ if there is no spring.
Then the overall force on each particle is
\begin{align}
 \particleForceStiff{\PidxI} = \sum_{\PidxII=1, \PidxII\neq\PidxI}^{\numParticles} \particleStiffness{\PidxI\PidxII} (\particlePos{\PidxII} - \particlePos{\PidxI}),
\qquad 
 \particleStiffness{\PidxI\PidxII} = \particleStiffness{\PidxII\PidxI}.
\end{align}
For a parameterized system \eqref{eq:ParticlePosParameterization} we have the \textit{generalized stiffness force}:
\begin{align}
 \genForceStiffCoeff{\LidxI}
 &= \sum_{\PidxI=1}^{\numParticles} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particleForceStiff{\PidxI}}
 = \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1, \PidxII\neq\PidxI}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI}\particlePos{\PidxI}}{\particlePos{\PidxII} - \particlePos{\PidxI}}
\nonumber\\
 &= \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particlePos{\PidxII} - \particlePos{\PidxI}}
  + \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxII\PidxI} \sProd{\dirDiff{\LidxI} \particlePos{\PidxII}}{\particlePos{\PidxI} - \particlePos{\PidxII}}
\nonumber\\
 &= -\tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI} (\particlePos{\PidxII} - \particlePos{\PidxI})}{\particlePos{\PidxII} - \particlePos{\PidxI}}
\nonumber\\
 &= -\dirDiff{\LidxI} \underbrace{\bigg( \tfrac{1}{4} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \norm{\particlePos{\PidxII} - \particlePos{\PidxI}}^2 \bigg)}_{\potentialStiff}
 = -\dirDiff{\LidxI} \underbrace{\bigg( \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=\PidxI+1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \norm{\particlePos{\PidxII} - \particlePos{\PidxI}}^2 \bigg)}_{\potentialStiff}
\end{align}
Since it can be derived from a potential $\potentialStiff:\configSpace\rightarrow\RealNum$, it is called a \textit{conservative force}.
Note that the non-negativity of the spring constants $\particleStiffness{\PidxI\PidxII} \geq 0, \PidxI,\PidxII=1,\ldots,\numParticles$ implies the non-negativity of the potential $\potentialStiff \geq 0$.


potential energy
\begin{align}
 \potentialStiff = \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=\PidxI+1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \norm{\particlePos{\PidxI} - \particlePos{\PidxII}}^2,
\qquad
 \genForceStiffCoeff{\LidxI} = \dirDiff{\LidxI} \potentialStiff
\end{align}
This identity might not be so obvious so we display the computation explicitly:
First note that due to $\particleStiffness{\PidxI\PidxII} = \particleStiffness{\PidxII\PidxI}$ and the obvious fact that the term for $\PidxII=\PidxI$ vanishes anyway, the potential can be expressed as
\begin{align}
 \potentialStiff &= \tfrac{1}{4} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \norm{\particlePos{\PidxI} - \particlePos{\PidxII}}^2
\end{align}
with this the directional derivatives are
\begin{align}
 \dirDiff{\LidxI} \potentialStiff
 &= \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI}\particlePos{\PidxI} - \dirDiff{\LidxI}\particlePos{\PidxII}}{\particlePos{\PidxI} - \particlePos{\PidxII}}
\nonumber\\
 &= \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI}\particlePos{\PidxI}}{\particlePos{\PidxI} - \particlePos{\PidxII}}
  + \tfrac{1}{2} \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI}\particlePos{\PidxII}}{\particlePos{\PidxII} - \particlePos{\PidxI}}
\nonumber\\
 &= \sum_{\PidxI=1}^{\numParticles} \sum_{\PidxII=1,\PidxII\neq\PidxI}^{\numParticles} \particleStiffness{\PidxI\PidxII} \sProd{\dirDiff{\LidxI}\particlePos{\PidxI}}{\particlePos{\PidxI} - \particlePos{\PidxII}}
\end{align}


\subsection{Gravitation}\label{sec:ParticleSysGravitation}
For far most engineering applications we are dealing with systems that move close to the surface of the earth and where Galilei's gravitation principle holds, see \cite[Day 3]{Galileo:TwoNewSciences}.
In a contemporary formulation it states that a particle with mass $\particleMass{\PidxI}$ is subject to the gravitational force
\begin{align}
 \particleForceGravity{\PidxI} = \particleMass{\PidxI} \gravityAcc
\end{align}
where $\gravityAcc$ are the coefficients of the gravitational acceleration of the earth w.r.t.\ the chosen inertial frame.
Commonly the inertial frame is chosen such that the $\ez$ axis is opposing gravity and we have $\gravityAcc = [0,0,-\gravityAccConst]^\top$ with the \textit{gravity of earth} $\gravityAccConst = 9.8\,\tfrac{\unit{m}}{\unit{s}^2}$.

The resulting generalized force for a system of particles is
\begin{align}\label{eq:ParticlePotentialGravity}
 \genForceGravityCoeff{\LidxI}
 = \sumParticles \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}}{\particleForceGravity{\PidxI}}
 = \sumParticles \particleMass{\PidxI} \sProd{\dirDiff{\LidxI}\particlePos{\PidxI}}{\gravityAcc}
 = \dirDiff{\LidxI} \underbrace{\sumParticles \particleMass{\PidxI} \sProd{\particlePos{\PidxI}}{\gravityAcc}}_{\potentialGravity}.
\end{align}
Since it can be derived from a potential $\potentialGravity:\configSpace\rightarrow\RealNum$, it is called a \textit{conservative force}.


\subsection{External forces}
Let external forces $\particleForceEx{\PidxI} = \particleForceEx{\PidxI}(\sysCoord, \sysVel, \sysInput)$
\begin{align}
 \genForceEx(\sysCoord, \sysVel, \sysInput) = \sumParticles \sProd{\dirDiff{\LidxI} \particlePos{\PidxI}(\sysCoord)}{\particleForceEx{\PidxI}(\sysCoord, \sysVel, \sysInput)}
\end{align}
